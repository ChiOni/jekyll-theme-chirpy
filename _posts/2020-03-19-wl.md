---

title: Weisfeiler - Lehman Kernal (NIPS 2009)
date: 2020-03-19 00:00:00 +0800
categories: [Paper Review, Graph]
tags: [graph classification, graph kernel]
seo:
  date_modified: 2020-03-19 20:07:02 +0800

---

지난 번 리뷰했던 <b>Deep Divergence Graph Kernal</b>의 논문에서 여러 번 등장했던 WL-kernel에 대해 간략히 리뷰해보고자 한다. 사실 그래프 분류 Task를 그래프 임베딩의 관점으로만 다루고자 했으나, 보려고 하는 여러 논문들에서 불편하게도 자꾸만 그래프 커널에 대해 언급되니 컨셉만이라도 이해해보고자 한다. 사실 그래프 커널에 대해 깊게 공부해 보는 것이 꺼려진 이유는, graph kernel의 목적이 두 그래프의 isomorphism을 찾는 Task, 즉 깊은 위상 수학의 개념들을 요구할 것이라는 막연한 두려움 때문이었는데.. 일단 봐보도록 한다.

<br/>

## <b>Weisfeiler - Lehman Test</b>

그래프 커널의 종류에는 walk based kernel / optimal assignment kernel / subtree kernel 등등 참 여러 종류가 있는 것 같다. 오늘은 그 중 DDGK에서 주요 실험 비교군으로 삼았던 WL - kernel을 보려고 한다. 비교적 최근(2011)에 등장한 해당 기법은 WL - test of isomorphism algorithm에 기초하고 있다하니 그거부터 살펴보자.

<br/>  
<img src="/assets/img/pr/wl/wlone.jpg">  
<br/>

자. 첫 줄부터 심각한 노테이션이지만 Multiset-label <b>M</b>이 의미하는 바를 먼저 이해해보자. 우선 Isomorphism을 비교하려는 두 그래프는 같은 노드 라벨을 공유한다는 전제에서 시작한다. 각 노드에 1 , 2 ,3 중 하나의 라벨이 존재한다고 생각해보자. 노드에 연결된 엣지의 개수에 따라 특정 노드가 가질 수 있는 연결 정보는 다양해진다. 하나의 엣지만 존재하는 경우에는 1 -> 2,   2 -> 3 의 연결 관계를 가질 수 있고, 두개의 엣지가 존재하는 경우(두 개의 노드로 이동 경로가 존재하는 경우)에는 1 -> 2,3,  2 -> 2,3 등의 정보가 있는 것이다. 그럼 이런 연결 관계 자체를 노드의 새로운 라벨로 정의한다. 사실 이렇게 글로만 봐서는 연결 정보를 새로운 노드로 정의한다는 M의 개념이 잘 이해가지 않는다. 따라서 NAVER D2에서 그림으로 잘 설명해주신 링크를 보고 이해하자.

[슬라이드 55번부터 보면 된다](https://pt.slideshare.net/uspace/graph-convolutional-neural-networks) 

즉, 연결관계를 새로운 라벨로 정의하고 나면 구조는 바뀌지 않은 채로 노드의 라벨만 바뀐 꼴이 되는데, 이 때 하나의 그래프에는 있는 라벨이 다른 레벨에는 없다면 두 그래프는 isomorphic 하지 않은 것이다. 그리고 이런 과정을 두 번 반복하면 그래프의 2-hob 까지의 연결 관계를 노드화하여 비교할 수 있다. 따라서 WL-Test는 사전에 정의한  n-hob의 연결 관계를 노드화하였을 때, 두 그래프의 label-set이 동일한가를 통해 Isomorphism을 확인하는 테스트라고 요약할 수 있다.

<br/>

## <b>Weisfeiler - Lehman Kernels</b>

커널에 s가 붙은 이유는 augment하는 주체에 따라 커널의 형태를 다양화할 수 있기 때문이다. 해당 논문에서는 sub-graph / edge / shortest path를 적용한 세 가지의 WL Kernel을 제시한다.

<br/>

#### <b>WL Kernel Framework</b>





