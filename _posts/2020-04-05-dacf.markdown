---
title: Deep Auto Correlation Function (Pytorch)
date: 2020-04-05 00:00:00 +0800
categories: [Code Excercise, Time Series]
tags: [time series,acf]
seo:
  date_modified: 2020-04-05 20:07:02 +0800
---

아주 많은 시계열 데이터를 딥러닝으로 서비스하는 상상을 해보면

1. GPU를 사용한 병렬처리를 통해 빠른 모델링이 가능하다.
2. 기존의 통계 모델에 대비하여 우수한 예측 성능을 기대한다.
3. 개별 시계열을 각각 모델링하지 않고 pre-trained한 모델을 재사용하는 것이 가능하다.

<br/>

전체적인 서비스는 (1)모델을 선택하는 부분과 (2)시계열을 적합하는 부분으로 나눌 수 있다.

서비스의 학습 전략도 두 파트로 나눌 수 있는데

1. 휴리스틱한 기준으로 기존에 존재하는 시계열을 분류하여 학습의 대상이 될 task set을 생성한다. 

   각 데이터 셋을 적합하는 rooted meta learner를 학습한다.

2. 새로운 시계열이 들어왔을 때 k번의 업데이트 이후  n개의 rooted meta learner 중에

   가장 예측 오차가 적은 모델이 선택되도록 분류 모델을 학습한다.

<br/>

1번의 경우에는 MAML의 학습 전략을 사용한 시중의 많은 시계열 예측 모델을 사용해 볼 수 있을 것이다. 2번의 경우에도 단순한 FC - Layer 구조로 분류 모델을 생성할 수 있다. 그러나 기존에 고려하지 못했던 시계열 형태로 인해 새로운 rooted meta learner가 필요하다거나, 적합되지 않는 long - tail 피쳐 스페이스의 시계열들을 역으로 분석하고 싶을 때에 이런 블랙 박스 모델은 여러 에러 사항을 갖는다. 따라서 지속적인 고도화와 해석의 용이함을 위해, 전통적인 시계열 Feature를 추출하는 모듈들을 각각 생성하고, 얻어진 결과물을 latent vector로 사용하여 분류 모델을 뒤에 태우는 구조를 제안한다.

<br/>

시계열에서 추출할 수 있는 다양한 변수 중에서 오늘은 주기성을 추출하는 딥러닝 모듈을 개발해보려고 한다.  일반적으로 시계열의 주기는 auto correlation function이라는 것을 통해서 추출되는데 

<img src="/assets/img/pe/dacf/dacfone.jpg">  

위와 같이 시계열들의 자기 상관 계수를 추출하고 통계적인 검정을 통해 상관의 정도가 얼마나 유의한지 계산한다. ACF의 경우에는 시계열을 몇 번 shift하여 상관계수를 추출할 것인가에 대한 후보군을 만들어 놓고 반복문을 돌며 가장 계수가 큰 후보를 채택하는 것이 일반적인데 

